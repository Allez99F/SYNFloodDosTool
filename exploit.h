/* File: exploit.h
 * Auth: isinstance
 * Date: 20171031
 * Mail: no
 */

#ifndef EXPLOIT_H
#define EXPLOIT_H

#define POST_MODEL "user=%s&password=%s&Submit=登+陆"
//#define POST_MODEL "user=%s&password=%s&Submit=E799BB+E99986"
//#define POST_MODEL "user=%s&password=%s&Submit=%E7%99%BB+%E9%99%86"
#define BUFFER_SIZE 1024

#define RAND_USER_NAME_DEFAULT 0
#define MAX_LOOP_TIME_DEFAULT -1
#define DEBUG_MODE_DEFAULT 0
#define NOT_RECV_DEFAULT 0
#define MAX_LOOP_NUM 1024

#define MAX_PROCESS_NUM 64
#define MAX_THREAD_NUM 16
// For test
//#define MAX_PROCESS_NUM 1
//#define MAX_THREAD_NUM 1

// Use the same socket to send message
// Used in http_post and with the -n option
#define MAX_SEND_TIME 10240

#define POST_URL "http://192.168.20.1/login.cgi"
#define PASSWD_FILE_PATH "/root/SPASSWD.txt"
#define USAGE "     Usage: ./length\n"                                                                                     \
              "     Or:    ./length -r -m[max_loop_time]\n"                                                                \
              "     -r   Use the random user name, if you have this option, you have to set the max_loop_time together\n" \
              "     -m   Set the every random user name max loop times, use with -r option\n"                             \
              "     -d   Debug mod\n"

struct INPUT_ARG
{
    int MaxLoopTime;
    int RandFlag;
    int DebugMode;
    int ThreadSeed;
    int NotRecv;
};

struct PARSE_RETURN
{
    int noption;
    int roption;
    int moption;
    int doption;
    int mvalue;
};

struct LIMITED_INPUT
{
    int MaxLoopTime;
    int DebugMode;
    int ThreadSeed;
    int NotRecv;
};

struct UNLIMITED_INPUT
{
    char *RandUserName;
    int DebugMode;
    int ThreadSeed;
    int NotRecv;
};

void *exploit(void *input);
struct PARSE_RETURN *parse_input(const int iargc, char **pargv);

#endif